<div class="conversations-page">
  <mat-list *ngIf="(conversationsDrawable$ | async) as conversations"
            class="conversation-list">
    <mat-action-list *ngFor="let conversation of conversations; trackBy: trackByUid">
      
      <button mat-list-item (click)="loadMessages(conversation.uid)">
        <ng-container *ngIf="conversation.users.length === 1; then privateChat; else groupChat">
        </ng-container>
      </button>
      
      <ng-template #privateChat>
        <span>{{ conversation.users[0].fullName }}</span>
      </ng-template>
      
      <ng-template #groupChat>
        <div *ngFor="let user of conversation.users; let last = last">
          <img class="user-avatar" [src]="user.avatarURL"/>
          <span>{{ user.fullName }}</span>
          <span *ngIf="!last" class="user-group-comma">,</span>
        </div>
      </ng-template>
    </mat-action-list>
  </mat-list>
  <button class="new-conversation-fab" (click)="createConversation()" mat-fab aria-label="new conversation">
    <mat-icon>message</mat-icon>
  </button>
</div>
